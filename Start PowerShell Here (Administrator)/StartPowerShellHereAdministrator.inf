[version]
Signature="$Windows NT$"

[StartPowerShellHereAdministratorInstall]
CopyFiles = StartPowerShellHereAdministrator.Files.Inf
CopyFiles = StartPowerShellHereAdministrator.Files.System
CopyFiles = StartPowerShellHereAdministrator.Files.Icon
AddReg    = StartPowerShellHereAdministrator.AddReg

[DefaultInstall]
CopyFiles = StartPowerShellHereAdministrator.Files.Inf
CopyFiles = StartPowerShellHereAdministrator.Files.System
CopyFiles = StartPowerShellHereAdministrator.Files.Icon
AddReg    = StartPowerShellHereAdministrator.AddReg

[DefaultUnInstall]
DelFiles  = StartPowerShellHereAdministrator.Files.Inf
DelFiles  = StartPowerShellHereAdministrator.Files.System
DelReg    = StartPowerShellHereAdministrator.DelReg

[SourceDisksNames]
55="Start PowerShell Here (Administrator)","",1

[SourceDisksFiles]
StartPowerShellHereAdministrator.INF=55
PowerShellAdmin32.ico=55

[DestinationDirs]
StartPowerShellHereAdministrator.Files.Inf = 17
StartPowerShellHereAdministrator.Files.System = 11
StartPowerShellHereAdministrator.Files.Icon = 11

[StartPowerShellHereAdministrator.Files.Inf]
StartPowerShellHereAdministrator.INF

[StartPowerShellHereAdministrator.Files.System]
Elevate.cmd
Elevate.vbs

[StartPowerShellHereAdministrator.Files.Icon]
PowerShellAdmin.ico

[StartPowerShellHereAdministrator.AddReg]
HKLM,%UDHERE%,DisplayName,,"%DisplayName%"
HKLM,%UDHERE%,DisplayVersion,,"%DisplayVersion%"
HKLM,%UDHERE%,DisplayIcon,,"%11%\PowerShellAdmin.ico"
HKLM,%UDHERE%,UninstallString,,"rundll32.exe syssetup.dll,SetupInfObjectInstallAction DefaultUninstall 132 %17%\StartPowerShellHereAdministrator.inf"

HKCR,Directory\Shell\StartPowerShellHereAdministrator,,,"%ContextText%"
HKCR,Directory\Shell\StartPowerShellHereAdministrator\command,,0x00020000,"""%SystemRoot%\System32\cmd.exe"" /c Elevate.cmd ""%SystemRoot%\System32\windowspowershell\v1.0\powershell.exe"" -NoExit -Command Set-Location -LiteralPath '%L'; $host.ui.rawui.windowtitle = 'Administrator: ' + $host.ui.rawui.windowtitle"
HKCR,Directory\Shell\StartPowerShellHereAdministrator,Icon,0x00020000,"%11%\PowerShellAdmin.ico"
HKCR,Directory\Shell\StartPowerShellHereAdministrator,Extended,,""
HKCR,Directory\Background\Shell\StartPowerShellHereAdministrator,,,"%ContextText%"
HKCR,Directory\Background\Shell\StartPowerShellHereAdministrator\command,,0x00020000,"""%SystemRoot%\System32\cmd.exe"" /c Elevate.cmd ""%SystemRoot%\System32\windowspowershell\v1.0\powershell.exe"" -NoExit ; $host.ui.rawui.windowtitle = 'Administrator: ' + $host.ui.rawui.windowtitle"
HKCR,Directory\Background\Shell\StartPowerShellHereAdministrator,Icon,0x00020000,"%11%\PowerShellAdmin.ico"
HKCR,Directory\Background\Shell\StartPowerShellHereAdministrator,Extended,,""
HKCR,Drive\Shell\StartPowerShellHereAdministrator,,,"%ContextText%"
HKCR,Drive\Shell\StartPowerShellHereAdministrator\command,,0x00020000,"""%SystemRoot%\System32\cmd.exe"" /c Elevate.cmd ""%SystemRoot%\System32\windowspowershell\v1.0\powershell.exe"" -NoExit -Command Set-Location -LiteralPath '%L'; $host.ui.rawui.windowtitle = 'Administrator: ' + $host.ui.rawui.windowtitle"
HKCR,Drive\Shell\StartPowerShellHereAdministrator,Icon,0x00020000,"%11%\PowerShellAdmin.ico"
HKCR,Drive\Shell\StartPowerShellHereAdministrator,Extended,,""

[StartPowerShellHereAdministrator.DelReg]
HKLM,%UDHERE%
HKCR,Directory\Shell\StartPowerShellHereAdministrator
HKCR,Directory\Shell\Background\StartPowerShellHereAdministrator
HKCR,Drive\Shell\StartPowerShellHereAdministrator

[Strings]
DisplayName="Start PowerShell Here (Administrator) (Uninstall only)"
DisplayVersion="1.0"
ContextText="Start PowerShell Here (&Administrator)"
UDHERE="Software\Microsoft\Windows\CurrentVersion\Uninstall\StartPowerShellHereAdministrator"
